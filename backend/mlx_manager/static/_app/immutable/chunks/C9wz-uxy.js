var Mt=Object.defineProperty;var Rt=Object.getPrototypeOf;var Lt=Reflect.get;var xe=t=>{throw TypeError(t)};var Ft=(t,e,r)=>e in t?Mt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var R=(t,e,r)=>Ft(t,typeof e!="symbol"?e+"":e,r),Qe=(t,e,r)=>e.has(t)||xe("Cannot "+r);var u=(t,e,r)=>(Qe(t,e,"read from private field"),r?r.call(t):e.get(t)),N=(t,e,r)=>e.has(t)?xe("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r);var V=(t,e,r)=>(Qe(t,e,"access private method"),r);var et=(t,e,r)=>Lt(Rt(t),r,e);import{D as Pe,b as Be,aO as dt,M as ee,h as b,ab as vt,c as Ae,g as m,Z as kt,J as Dt,K as Vt,L as tt,N as G,G as Y,al as qt,aG as Bt,ar as rt,z as be,aP as H,F as fe,I as Ut,V as $e,R as jt,aE as Ue,aQ as gt,aR as Ht,aS as Kt,aT as Wt,A as pt,C as _t,aU as Fe,ak as mt,aA as Jt,aV as Yt,aD as Gt,B as Te,E as yt,aW as Zt,aX as Xt,U as xt,O as St,aY as wt,aJ as je,aM as Qt,aZ as er,a_ as tr,aN as rr,a$ as sr,b0 as ir,b1 as ar,b2 as nr,b3 as or,b4 as lr,b5 as fr,b6 as ur,b7 as cr,i as C,b8 as Ne,e as O,aj as W,_ as Pt,p as hr,a as dr,m as st,w as se,d as vr,s as gr,r as pr,f as _r,u as mr,b9 as yr}from"./v4vcYSfj.js";import{B as bt,l as it,p as x}from"./CQCzmFHa.js";import{b as Sr,e as wr,a as at,c as Pr}from"./BwiJqY1Q.js";import{i as br}from"./QUEjkrZk.js";import{i as Er,a as Ar,c as $r,d as Tr,n as Nr,b as Or}from"./CYs-NoBq.js";function Cr(t,e){return e}function Ir(t,e,r){for(var s=[],i=e.length,a,n=e.length,o=0;o<i;o++){let g=e[o];_t(g,()=>{if(a){if(a.pending.delete(g),a.done.add(g),a.pending.size===0){var d=t.outrogroups;qe(Ue(a.done)),d.delete(a),d.size===0&&(t.outrogroups=null)}}else n-=1},!1)}if(n===0){var l=s.length===0&&r!==null;if(l){var c=r,h=c.parentNode;Gt(h),h.append(c),t.items.clear()}qe(e,!l)}else a={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(a)}function qe(t,e=!0){for(var r=0;r<t.length;r++)Te(t[r],e)}var nt;function zr(t,e,r,s,i,a=null){var n=t,o=new Map,l=(e&dt)!==0;if(l){var c=t;n=b?ee(vt(c)):c.appendChild(Pe())}b&&Ae();var h=null,g=kt(()=>{var v=r();return gt(v)?v:v==null?[]:Ue(v)}),d,y=!0;function P(){f.fallback=h,Mr(f,d,n,e,s),h!==null&&(d.length===0?(h.f&H)===0?pt(h):(h.f^=H,ne(h,null,n)):_t(h,()=>{h=null}))}var $=Be(()=>{d=m(g);var v=d.length;let F=!1;if(b){var I=Dt(n)===Vt;I!==(v===0)&&(n=tt(),ee(n),G(!1),F=!0)}for(var S=new Set,M=be,_=Ut(),p=0;p<v;p+=1){b&&Y.nodeType===qt&&Y.data===Bt&&(n=Y,F=!0,G(!1));var T=d[p],z=s(T,p),w=y?null:o.get(z);w?(w.v&&rt(w.v,T),w.i&&rt(w.i,p),_&&M.skipped_effects.delete(w.e)):(w=Rr(o,y?n:nt??(nt=Pe()),T,z,p,i,e,r),y||(w.e.f|=H),o.set(z,w)),S.add(z)}if(v===0&&a&&!h&&(y?h=fe(()=>a(n)):(h=fe(()=>a(nt??(nt=Pe()))),h.f|=H)),b&&v>0&&ee(tt()),!y)if(_){for(const[Z,X]of o)S.has(Z)||M.skipped_effects.add(X.e);M.oncommit(P),M.ondiscard(()=>{})}else P();F&&G(!0),m(g)}),f={effect:$,items:o,outrogroups:null,fallback:h};y=!1,b&&(n=Y)}function Mr(t,e,r,s,i){var w,Z,X,Ke,We,Je,Ye,Ge,Ze;var a=(s&Yt)!==0,n=e.length,o=t.items,l=t.effect.first,c,h=null,g,d=[],y=[],P,$,f,v;if(a)for(v=0;v<n;v+=1)P=e[v],$=i(P,v),f=o.get($).e,(f.f&H)===0&&((Z=(w=f.nodes)==null?void 0:w.a)==null||Z.measure(),(g??(g=new Set)).add(f));for(v=0;v<n;v+=1){if(P=e[v],$=i(P,v),f=o.get($).e,t.outrogroups!==null)for(const U of t.outrogroups)U.pending.delete(f),U.done.delete(f);if((f.f&H)!==0)if(f.f^=H,f===l)ne(f,null,r);else{var F=h?h.next:l;f===t.effect.last&&(t.effect.last=f.prev),f.prev&&(f.prev.next=f.next),f.next&&(f.next.prev=f.prev),K(t,h,f),K(t,f,F),ne(f,F,r),h=f,d=[],y=[],l=h.next;continue}if((f.f&Fe)!==0&&(pt(f),a&&((Ke=(X=f.nodes)==null?void 0:X.a)==null||Ke.unfix(),(g??(g=new Set)).delete(f))),f!==l){if(c!==void 0&&c.has(f)){if(d.length<y.length){var I=y[0],S;h=I.prev;var M=d[0],_=d[d.length-1];for(S=0;S<d.length;S+=1)ne(d[S],I,r);for(S=0;S<y.length;S+=1)c.delete(y[S]);K(t,M.prev,_.next),K(t,h,M),K(t,_,I),l=I,h=_,v-=1,d=[],y=[]}else c.delete(f),ne(f,l,r),K(t,f.prev,f.next),K(t,f,h===null?t.effect.first:h.next),K(t,h,f),h=f;continue}for(d=[],y=[];l!==null&&l!==f;)(c??(c=new Set)).add(l),y.push(l),l=l.next;if(l===null)continue}(f.f&H)===0&&d.push(f),h=f,l=f.next}if(t.outrogroups!==null){for(const U of t.outrogroups)U.pending.size===0&&(qe(Ue(U.done)),(We=t.outrogroups)==null||We.delete(U));t.outrogroups.size===0&&(t.outrogroups=null)}if(l!==null||c!==void 0){var p=[];if(c!==void 0)for(f of c)(f.f&Fe)===0&&p.push(f);for(;l!==null;)(l.f&Fe)===0&&l!==t.fallback&&p.push(l),l=l.next;var T=p.length;if(T>0){var z=(s&dt)!==0&&n===0?r:null;if(a){for(v=0;v<T;v+=1)(Ye=(Je=p[v].nodes)==null?void 0:Je.a)==null||Ye.measure();for(v=0;v<T;v+=1)(Ze=(Ge=p[v].nodes)==null?void 0:Ge.a)==null||Ze.fix()}Ir(t,p,z)}}a&&mt(()=>{var U,Xe;if(g!==void 0)for(f of g)(Xe=(U=f.nodes)==null?void 0:U.a)==null||Xe.apply()})}function Rr(t,e,r,s,i,a,n,o){var l=(n&Ht)!==0?(n&Kt)===0?jt(r,!1,!1):$e(r):null,c=(n&Wt)!==0?$e(i):null;return{v:l,i:c,e:fe(()=>(a(e,l??r,c??i,o),()=>{t.delete(s)}))}}function ne(t,e,r){if(t.nodes)for(var s=t.nodes.start,i=t.nodes.end,a=e&&(e.f&H)===0?e.nodes.start:r;s!==null;){var n=Jt(s);if(a.before(s),s===i)return;s=n}}function K(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function Lr(t,e,r,s,i){var o;b&&Ae();var a=(o=e.$$slots)==null?void 0:o[r],n=!1;a===!0&&(a=e.children,n=!0),a===void 0||a(t,n?()=>s:s)}function vs(t,e,...r){var s=new bt(t);Be(()=>{const i=e()??null;s.ensure(i,i&&(a=>i(a,...r)))},yt)}function Fr(t,e,r,s,i,a){let n=b;b&&Ae();var o=null;b&&Y.nodeType===Zt&&(o=Y,Ae());var l=b?Y:t,c=new bt(l,!1);Be(()=>{const h=e()||null;var g=Xt;if(h===null){c.ensure(null,null);return}return c.ensure(h,d=>{if(h){if(o=b?o:document.createElementNS(g,h),Sr(o,o),s){b&&Er(h)&&o.append(document.createComment(""));var y=b?vt(o):o.appendChild(Pe());b&&(y===null?G(!1):ee(y)),s(o,y)}xt.nodes.end=o,d.before(o)}b&&ee(d)}),()=>{}},yt),St(()=>{}),n&&(G(!0),ee(l))}function kr(t,e){var r=void 0,s;wt(()=>{r!==(r=e())&&(s&&(Te(s),s=null),r&&(s=fe(()=>{je(()=>r(t))})))})}function Et(t){var e,r,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=Et(t[e]))&&(s&&(s+=" "),s+=r)}else for(r in t)t[r]&&(s&&(s+=" "),s+=r);return s}function Dr(){for(var t,e,r=0,s="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=Et(t))&&(s&&(s+=" "),s+=e);return s}function Vr(t){return typeof t=="object"?Dr(t):t??""}const ot=[...` 	
\r\fÂ \v\uFEFF`];function qr(t,e,r){var s=t==null?"":""+t;if(r){for(var i in r)if(r[i])s=s?s+" "+i:i;else if(s.length)for(var a=i.length,n=0;(n=s.indexOf(i,n))>=0;){var o=n+a;(n===0||ot.includes(s[n-1]))&&(o===s.length||ot.includes(s[o]))?s=(n===0?"":s.substring(0,n))+s.substring(o+1):n=o}}return s===""?null:s}function lt(t,e=!1){var r=e?" !important;":";",s="";for(var i in t){var a=t[i];a!=null&&a!==""&&(s+=" "+i+": "+a+r)}return s}function ke(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Br(t,e){if(e){var r="",s,i;if(Array.isArray(e)?(s=e[0],i=e[1]):s=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,n=0,o=!1,l=[];s&&l.push(...Object.keys(s).map(ke)),i&&l.push(...Object.keys(i).map(ke));var c=0,h=-1;const $=t.length;for(var g=0;g<$;g++){var d=t[g];if(o?d==="/"&&t[g-1]==="*"&&(o=!1):a?a===d&&(a=!1):d==="/"&&t[g+1]==="*"?o=!0:d==='"'||d==="'"?a=d:d==="("?n++:d===")"&&n--,!o&&a===!1&&n===0){if(d===":"&&h===-1)h=g;else if(d===";"||g===$-1){if(h!==-1){var y=ke(t.substring(c,h).trim());if(!l.includes(y)){d!==";"&&g++;var P=t.substring(c,g).trim();r+=" "+P+";"}}c=g+1,h=-1}}}}return s&&(r+=lt(s)),i&&(r+=lt(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Ur(t,e,r,s,i,a){var n=t.__className;if(b||n!==r||n===void 0){var o=qr(r,s,a);(!b||o!==t.getAttribute("class"))&&(o==null?t.removeAttribute("class"):e?t.className=o:t.setAttribute("class",o)),t.__className=r}else if(a&&i!==a)for(var l in a){var c=!!a[l];(i==null||c!==!!i[l])&&t.classList.toggle(l,c)}return a}function De(t,e={},r,s){for(var i in r){var a=r[i];e[i]!==a&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,a,s))}}function jr(t,e,r,s){var i=t.__style;if(b||i!==e){var a=Br(e,s);(!b||a!==t.getAttribute("style"))&&(a==null?t.removeAttribute("style"):t.style.cssText=a),t.__style=e}else s&&(Array.isArray(s)?(De(t,r==null?void 0:r[0],s[0]),De(t,r==null?void 0:r[1],s[1],"important")):De(t,r,s));return s}function Oe(t,e,r=!1){if(t.multiple){if(e==null)return;if(!gt(e))return er();for(var s of t.options)s.selected=e.includes(le(s));return}for(s of t.options){var i=le(s);if(tr(i,e)){s.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function At(t){var e=new MutationObserver(()=>{Oe(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),St(()=>{e.disconnect()})}function gs(t,e,r=e){var s=new WeakSet,i=!0;Qt(t,"change",a=>{var n=a?"[selected]":":checked",o;if(t.multiple)o=[].map.call(t.querySelectorAll(n),le);else{var l=t.querySelector(n)??t.querySelector("option:not([disabled])");o=l&&le(l)}r(o),be!==null&&s.add(be)}),je(()=>{var a=e();if(t===document.activeElement){var n=rr??be;if(s.has(n))return}if(Oe(t,a,i),i&&a===void 0){var o=t.querySelector(":checked");o!==null&&(a=le(o),r(a))}t.__value=a,i=!1}),At(t)}function le(t){return"__value"in t?t.__value:t.value}const ie=Symbol("class"),ae=Symbol("style"),$t=Symbol("is custom element"),Tt=Symbol("is html");function Hr(t){if(b){var e=!1,r=()=>{if(!e){if(e=!0,t.hasAttribute("value")){var s=t.value;Ce(t,"value",null),t.value=s}if(t.hasAttribute("checked")){var i=t.checked;Ce(t,"checked",null),t.checked=i}}};t.__on_r=r,mt(r),cr()}}function Kr(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function Ce(t,e,r,s){var i=Nt(t);b&&(i[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||i[e]!==(i[e]=r)&&(e==="loading"&&(t[ir]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Ot(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Wr(t,e,r,s,i=!1,a=!1){if(b&&i&&t.tagName==="INPUT"){var n=t,o=n.type==="checkbox"?"defaultChecked":"defaultValue";o in r||Hr(n)}var l=Nt(t),c=l[$t],h=!l[Tt];let g=b&&c;g&&G(!1);var d=e||{},y=t.tagName==="OPTION";for(var P in e)P in r||(r[P]=null);r.class?r.class=Vr(r.class):r[ie]&&(r.class=null),r[ae]&&(r.style??(r.style=null));var $=Ot(t);for(const _ in r){let p=r[_];if(y&&_==="value"&&p==null){t.value=t.__value="",d[_]=p;continue}if(_==="class"){var f=t.namespaceURI==="http://www.w3.org/1999/xhtml";Ur(t,f,p,s,e==null?void 0:e[ie],r[ie]),d[_]=p,d[ie]=r[ie];continue}if(_==="style"){jr(t,p,e==null?void 0:e[ae],r[ae]),d[_]=p,d[ae]=r[ae];continue}var v=d[_];if(!(p===v&&!(p===void 0&&t.hasAttribute(_)))){d[_]=p;var F=_[0]+_[1];if(F!=="$$")if(F==="on"){const T={},z="$$"+_;let w=_.slice(2);var I=Or(w);if(Ar(w)&&(w=w.slice(0,-7),T.capture=!0),!I&&v){if(p!=null)continue;t.removeEventListener(w,d[z],T),d[z]=null}if(p!=null)if(I)t[`__${w}`]=p,Tr([w]);else{let Z=function(X){d[_].call(this,X)};d[z]=$r(w,t,Z,T)}else I&&(t[`__${w}`]=void 0)}else if(_==="style")Ce(t,_,p);else if(_==="autofocus")fr(t,!!p);else if(!c&&(_==="__value"||_==="value"&&p!=null))t.value=t.__value=p;else if(_==="selected"&&y)Kr(t,p);else{var S=_;h||(S=Nr(S));var M=S==="defaultValue"||S==="defaultChecked";if(p==null&&!c&&!M)if(l[_]=null,S==="value"||S==="checked"){let T=t;const z=e===void 0;if(S==="value"){let w=T.defaultValue;T.removeAttribute(S),T.defaultValue=w,T.value=T.__value=z?w:null}else{let w=T.defaultChecked;T.removeAttribute(S),T.defaultChecked=w,T.checked=z?w:!1}}else t.removeAttribute(_);else M||$.includes(S)&&(c||typeof p!="string")?(t[S]=p,S in l&&(l[S]=ur)):typeof p!="function"&&Ce(t,S,p)}}}return g&&G(!0),d}function ft(t,e,r=[],s=[],i=[],a,n=!1,o=!1){sr(i,r,s,l=>{var c=void 0,h={},g=t.nodeName==="SELECT",d=!1;if(wt(()=>{var P=e(...l.map(m)),$=Wr(t,c,P,a,n,o);d&&g&&"value"in P&&Oe(t,P.value);for(let v of Object.getOwnPropertySymbols(h))P[v]||Te(h[v]);for(let v of Object.getOwnPropertySymbols(P)){var f=P[v];v.description===or&&(!c||f!==c[v])&&(h[v]&&Te(h[v]),h[v]=fe(()=>kr(t,()=>f))),$[v]=f}c=$}),g){var y=t;je(()=>{Oe(y,c.value,!0),At(y)})}d=!0})}function Nt(t){return t.__attributes??(t.__attributes={[$t]:t.nodeName.includes("-"),[Tt]:t.namespaceURI===ar})}var ut=new Map;function Ot(t){var e=t.getAttribute("is")||t.nodeName,r=ut.get(e);if(r)return r;ut.set(e,r=[]);for(var s,i=t,a=Element.prototype;a!==i;){s=lr(i);for(var n in s)s[n].set&&r.push(n);i=nr(i)}return r}const E="/api";class Jr extends Error{constructor(e,r){super(r),this.status=e,this.name="ApiError"}}async function A(t){if(!t.ok){const e=await t.text();let r=e;try{const s=JSON.parse(e);r=s.detail||s.message||e}catch{}throw new Jr(t.status,r)}if(t.status!==204)return t.json()}const Q={list:async()=>{const t=await fetch(`${E}/profiles`);return A(t)},get:async t=>{const e=await fetch(`${E}/profiles/${t}`);return A(e)},create:async t=>{const e=await fetch(`${E}/profiles`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return A(e)},update:async(t,e)=>{const r=await fetch(`${E}/profiles/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return A(r)},delete:async t=>{const e=await fetch(`${E}/profiles/${t}`,{method:"DELETE"});return A(e)},duplicate:async(t,e)=>{const r=await fetch(`${E}/profiles/${t}/duplicate?new_name=${encodeURIComponent(e)}`,{method:"POST"});return A(r)},getNextPort:async()=>{const t=await fetch(`${E}/profiles/next-port`);return A(t)}},ps={search:async(t,e,r=20)=>{const s=new URLSearchParams({query:t,limit:r.toString()});e!==void 0&&s.set("max_size_gb",e.toString());const i=await fetch(`${E}/models/search?${s}`);return A(i)},listLocal:async()=>{const t=await fetch(`${E}/models/local`);return A(t)},startDownload:async t=>{const e=await fetch(`${E}/models/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model_id:t})});return A(e)},delete:async t=>{const e=await fetch(`${E}/models/${encodeURIComponent(t)}`,{method:"DELETE"});return A(e)},detectOptions:async t=>{const e=await fetch(`${E}/models/detect-options/${encodeURIComponent(t)}`);return A(e)},getAvailableParsers:async()=>{const t=await fetch(`${E}/models/available-parsers`);return A(t)}},Se={list:async()=>{const t=await fetch(`${E}/servers`);return A(t)},start:async t=>{const e=await fetch(`${E}/servers/${t}/start`,{method:"POST"});return A(e)},stop:async(t,e=!1)=>{const s=await fetch(`${E}/servers/${t}/stop${e?"?force=true":""}`,{method:"POST"});return A(s)},restart:async t=>{const e=await fetch(`${E}/servers/${t}/restart`,{method:"POST"});return A(e)},health:async t=>{const e=await fetch(`${E}/servers/${t}/health`);return A(e)},status:async t=>{const e=await fetch(`${E}/servers/${t}/status`);return A(e)}},ct={memory:async()=>{const t=await fetch(`${E}/system/memory`);return A(t)},info:async()=>{const t=await fetch(`${E}/system/info`);return A(t)},launchd:{install:async t=>{const e=await fetch(`${E}/system/launchd/install/${t}`,{method:"POST"});return A(e)},uninstall:async t=>{const e=await fetch(`${E}/system/launchd/uninstall/${t}`,{method:"POST"});return A(e)},status:async t=>{const e=await fetch(`${E}/system/launchd/status/${t}`);return A(e)}}};function Yr(t,e){const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(const i of r)if(t[i]!==e[i])return!1;return!0}function Ct(t,e,r){const{getKey:s,isEqual:i=Yr}=r,a=new Map;t.forEach((c,h)=>{a.set(s(c),{item:c,index:h})});const n=new Set(e.map(s)),o=[];let l=!1;for(const c of e){const h=s(c),g=a.get(h);g?(i(g.item,c)||(Object.assign(g.item,c),l=!0),o.push(g.item)):(o.push(c),l=!0)}for(const[c]of a)if(!n.has(c)){l=!0;break}if(!l&&t.length===o.length){for(let c=0;c<t.length;c++)if(s(t[c])!==s(o[c])){l=!0;break}}return l||t.length!==o.length?(t.length=0,t.push(...o),!0):!1}class Gr{constructor(){R(this,"inFlight",new Map);R(this,"lastRefresh",new Map);R(this,"pollingState",new Map);R(this,"isVisible",!0);R(this,"globalPause",!1);R(this,"visibilityListenerAttached",!1);this.setupVisibilityListener()}setupVisibilityListener(){typeof document>"u"||this.visibilityListenerAttached||(this.isVisible=document.visibilityState==="visible",document.addEventListener("visibilitychange",()=>{const e=this.isVisible;this.isVisible=document.visibilityState==="visible",this.isVisible&&!e?this.resumeAll():!this.isVisible&&e&&this.pauseAll()}),this.visibilityListenerAttached=!0)}register(e,r){const s=this.pollingState.get(e);s?s.config=r:this.pollingState.set(e,{config:r,intervalId:null,paused:!1})}start(e){const r=this.pollingState.get(e);if(!r){console.warn(`[PollingCoordinator] No config registered for ${e}`);return}this.stop(e),r.paused=!1,this.refresh(e),r.intervalId=setInterval(()=>{this.shouldPoll(e)&&this.refresh(e)},r.config.interval)}stop(e){const r=this.pollingState.get(e);r!=null&&r.intervalId&&(clearInterval(r.intervalId),r.intervalId=null)}async refresh(e){const r=this.pollingState.get(e);if(!r){console.warn(`[PollingCoordinator] No config registered for ${e}`);return}const s=this.inFlight.get(e);if(s)return s;const i=this.lastRefresh.get(e)??0;if(Date.now()-i<r.config.minInterval)return;const n=r.config.refreshFn().catch(o=>{console.error(`[PollingCoordinator] Refresh failed for ${e}:`,o)}).finally(()=>{this.inFlight.delete(e),this.lastRefresh.set(e,Date.now())});return this.inFlight.set(e,n),n}shouldPoll(e){if(!this.isVisible||this.globalPause)return!1;const r=this.pollingState.get(e);return!(r!=null&&r.paused)}pauseAll(){for(const[,e]of this.pollingState)e.intervalId&&(clearInterval(e.intervalId),e.intervalId=null)}resumeAll(){for(const[e,r]of this.pollingState)!r.paused&&!r.intervalId&&(this.refresh(e),r.intervalId=setInterval(()=>{this.shouldPoll(e)&&this.refresh(e)},r.config.interval))}isRefreshing(e){return this.inFlight.has(e)}getTimeSinceRefresh(e){const r=this.lastRefresh.get(e);return r?Date.now()-r:1/0}setGlobalPause(e){this.globalPause=e,e?this.pauseAll():this.isVisible&&this.resumeAll()}pause(e){const r=this.pollingState.get(e);r&&(r.paused=!0,this.stop(e))}resume(e){const r=this.pollingState.get(e);r&&(r.paused=!1,this.isVisible&&!this.globalPause&&this.start(e))}isPolling(e){const r=this.pollingState.get(e);return(r==null?void 0:r.intervalId)!=null}destroy(){for(const[e]of this.pollingState)this.stop(e);this.pollingState.clear(),this.inFlight.clear(),this.lastRefresh.clear()}}const L=new Gr;var Zr=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],Xr=["difference","intersection","symmetricDifference","union"],ht=!1,te,k,J,Me,re,It,zt;const Re=class Re extends Set{constructor(r){super();N(this,re);N(this,te,new Map);N(this,k,C(0));N(this,J,C(0));N(this,Me,Ne||-1);if(r){for(var s of r)super.add(s);u(this,J).v=super.size}ht||V(this,re,zt).call(this)}has(r){var s=super.has(r),i=u(this,te),a=i.get(r);if(a===void 0){if(!s)return m(u(this,k)),!1;a=V(this,re,It).call(this,!0),i.set(r,a)}return m(a),s}add(r){return super.has(r)||(super.add(r),O(u(this,J),super.size),W(u(this,k))),this}delete(r){var s=super.delete(r),i=u(this,te),a=i.get(r);return a!==void 0&&(i.delete(r),O(a,!1)),s&&(O(u(this,J),super.size),W(u(this,k))),s}clear(){if(super.size!==0){super.clear();var r=u(this,te);for(var s of r.values())O(s,!1);r.clear(),O(u(this,J),0),W(u(this,k))}}keys(){return this.values()}values(){return m(u(this,k)),super.values()}entries(){return m(u(this,k)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return m(u(this,J))}};te=new WeakMap,k=new WeakMap,J=new WeakMap,Me=new WeakMap,re=new WeakSet,It=function(r){return Ne===u(this,Me)?C(r):$e(r)},zt=function(){ht=!0;var r=Re.prototype,s=Set.prototype;for(const i of Zr)r[i]=function(...a){return m(u(this,k)),s[i].apply(this,a)};for(const i of Xr)r[i]=function(...a){m(u(this,k));var n=s[i].apply(this,a);return new Re(n)}};let Ie=Re;var q,B,j,Le,D,oe,Ee;const He=class He extends Map{constructor(r){super();N(this,D);N(this,q,new Map);N(this,B,C(0));N(this,j,C(0));N(this,Le,Ne||-1);if(r){for(var[s,i]of r)super.set(s,i);u(this,j).v=super.size}}has(r){var s=u(this,q),i=s.get(r);if(i===void 0){var a=super.get(r);if(a!==void 0)i=V(this,D,oe).call(this,0),s.set(r,i);else return m(u(this,B)),!1}return m(i),!0}forEach(r,s){V(this,D,Ee).call(this),super.forEach(r,s)}get(r){var s=u(this,q),i=s.get(r);if(i===void 0){var a=super.get(r);if(a!==void 0)i=V(this,D,oe).call(this,0),s.set(r,i);else{m(u(this,B));return}}return m(i),super.get(r)}set(r,s){var g;var i=u(this,q),a=i.get(r),n=super.get(r),o=super.set(r,s),l=u(this,B);if(a===void 0)a=V(this,D,oe).call(this,0),i.set(r,a),O(u(this,j),super.size),W(l);else if(n!==s){W(a);var c=l.reactions===null?null:new Set(l.reactions),h=c===null||!((g=a.reactions)!=null&&g.every(d=>c.has(d)));h&&W(l)}return o}delete(r){var s=u(this,q),i=s.get(r),a=super.delete(r);return i!==void 0&&(s.delete(r),O(u(this,j),super.size),O(i,-1),W(u(this,B))),a}clear(){if(super.size!==0){super.clear();var r=u(this,q);O(u(this,j),0);for(var s of r.values())O(s,-1);W(u(this,B)),r.clear()}}keys(){return m(u(this,B)),super.keys()}values(){return V(this,D,Ee).call(this),super.values()}entries(){return V(this,D,Ee).call(this),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return m(u(this,j)),super.size}};q=new WeakMap,B=new WeakMap,j=new WeakMap,Le=new WeakMap,D=new WeakSet,oe=function(r){return Ne===u(this,Le)?C(r):$e(r)},Ee=function(){m(u(this,B));var r=u(this,q);if(u(this,j).v!==r.size){for(var s of et(He.prototype,this,"keys").call(this))if(!r.has(s)){var i=V(this,D,oe).call(this,0);r.set(s,i)}}for([,i]of u(this,q))m(i)};let ze=He;function xr(t,e){return t.profile_id===e.profile_id&&t.profile_name===e.profile_name&&t.pid===e.pid&&t.port===e.port&&t.health_status===e.health_status&&Math.abs(t.uptime_seconds-e.uptime_seconds)<2&&Math.abs(t.memory_mb-e.memory_mb)<1}const Ve="__serverStoreHmrState";function Qr(){if(typeof window<"u"){const t=window;return t[Ve]||(t[Ve]={servers:[],startingProfiles:new Ie,failedProfiles:new ze,pollingProfiles:new Set}),t[Ve]}return{servers:[],startingProfiles:new Ie,failedProfiles:new ze,pollingProfiles:new Set}}const we=Qr();var ue,ce,he;class es{constructor(){N(this,ue,C(Pt(we.servers)));N(this,ce,C(!1));N(this,he,C(null));R(this,"startingProfiles",we.startingProfiles);R(this,"failedProfiles",we.failedProfiles);R(this,"pollingProfiles",we.pollingProfiles);R(this,"pollingInitialized",!1);L.register("servers",{interval:5e3,minInterval:1e3,refreshFn:()=>this.doRefresh()})}get servers(){return m(u(this,ue))}set servers(e){O(u(this,ue),e,!0)}get loading(){return m(u(this,ce))}set loading(e){O(u(this,ce),e,!0)}get error(){return m(u(this,he))}set error(e){O(u(this,he),e,!0)}async doRefresh(){this.loading=!0,this.error=null;try{const e=await Se.list();Ct(this.servers,e,{getKey:r=>r.profile_id,isEqual:xr})}catch(e){this.error=e instanceof Error?e.message:"Failed to fetch servers"}finally{this.loading=!1}}async refresh(){return L.refresh("servers")}startPolling(){this.pollingInitialized||(L.start("servers"),this.pollingInitialized=!0)}stopPolling(){L.stop("servers"),this.pollingInitialized=!1}async start(e){this.startingProfiles.add(e),this.failedProfiles.delete(e),await Se.start(e)}async stop(e,r=!1){this.startingProfiles.delete(e),this.failedProfiles.delete(e),await Se.stop(e,r),await this.refresh()}async restart(e){this.startingProfiles.add(e),this.failedProfiles.delete(e),await Se.restart(e)}markStartupSuccess(e){this.startingProfiles.delete(e),this.failedProfiles.delete(e),this.refresh()}markStartupFailed(e,r,s=null){console.log(`[ServerStore] markStartupFailed called for profile ${e}`),console.log(`[ServerStore] Error: ${r}`),console.log(`[ServerStore] Before - startingProfiles.has(${e}):`,this.startingProfiles.has(e)),console.log(`[ServerStore] Before - failedProfiles.has(${e}):`,this.failedProfiles.has(e)),this.startingProfiles.delete(e);const i=this.failedProfiles.get(e),a=(i==null?void 0:i.detailsOpen)??!1;this.failedProfiles.set(e,{error:r,details:s,detailsOpen:a}),console.log(`[ServerStore] After - startingProfiles.has(${e}):`,this.startingProfiles.has(e)),console.log(`[ServerStore] After - failedProfiles.has(${e}):`,this.failedProfiles.has(e)),console.log("[ServerStore] failedProfiles size:",this.failedProfiles.size),console.log(`[ServerStore] failedProfiles.get(${e}):`,this.failedProfiles.get(e)),this.refresh()}toggleDetailsOpen(e){const r=this.failedProfiles.get(e);r&&this.failedProfiles.set(e,{...r,detailsOpen:!r.detailsOpen})}clearFailure(e){this.failedProfiles.delete(e)}isRunning(e){return this.servers.some(r=>r.profile_id===e)&&!this.startingProfiles.has(e)}isStarting(e){return this.startingProfiles.has(e)}isFailed(e){return this.failedProfiles.has(e)}getFailure(e){return this.failedProfiles.get(e)}getServer(e){return this.servers.find(r=>r.profile_id===e)}isProfilePolling(e){return this.pollingProfiles.has(e)}startProfilePolling(e){return this.pollingProfiles.has(e)?(console.log(`[ServerStore] Profile ${e} already has active polling, skipping`),!1):(this.pollingProfiles.add(e),console.log(`[ServerStore] Started polling for profile ${e}`),!0)}stopProfilePolling(e){this.pollingProfiles.delete(e),console.log(`[ServerStore] Stopped polling for profile ${e}`)}}ue=new WeakMap,ce=new WeakMap,he=new WeakMap;const _s=new es;function ts(t,e){return t.id===e.id&&t.name===e.name&&t.description===e.description&&t.model_path===e.model_path&&t.model_type===e.model_type&&t.port===e.port&&t.host===e.host&&t.context_length===e.context_length&&t.max_concurrency===e.max_concurrency&&t.queue_timeout===e.queue_timeout&&t.queue_size===e.queue_size&&t.tool_call_parser===e.tool_call_parser&&t.reasoning_parser===e.reasoning_parser&&t.enable_auto_tool_choice===e.enable_auto_tool_choice&&t.trust_remote_code===e.trust_remote_code&&t.chat_template_file===e.chat_template_file&&t.log_level===e.log_level&&t.log_file===e.log_file&&t.no_log_file===e.no_log_file&&t.auto_start===e.auto_start&&t.launchd_installed===e.launchd_installed&&t.created_at===e.created_at&&t.updated_at===e.updated_at}var de,ve,ge;class rs{constructor(){N(this,de,C(Pt([])));N(this,ve,C(!1));N(this,ge,C(null));R(this,"pollingInitialized",!1);L.register("profiles",{interval:1e4,minInterval:1e3,refreshFn:()=>this.doRefresh()})}get profiles(){return m(u(this,de))}set profiles(e){O(u(this,de),e,!0)}get loading(){return m(u(this,ve))}set loading(e){O(u(this,ve),e,!0)}get error(){return m(u(this,ge))}set error(e){O(u(this,ge),e,!0)}async doRefresh(){this.loading=!0,this.error=null;try{const e=await Q.list();Ct(this.profiles,e,{getKey:r=>r.id,isEqual:ts})}catch(e){this.error=e instanceof Error?e.message:"Failed to fetch profiles"}finally{this.loading=!1}}async refresh(){return L.refresh("profiles")}startPolling(){this.pollingInitialized||(L.start("profiles"),this.pollingInitialized=!0)}stopPolling(){L.stop("profiles"),this.pollingInitialized=!1}async create(e){const r=await Q.create(e);return await this.refresh(),r}async update(e,r){const s=await Q.update(e,r);return await this.refresh(),s}async delete(e){await Q.delete(e),await this.refresh()}async duplicate(e,r){const s=await Q.duplicate(e,r);return await this.refresh(),s}async getNextPort(){return(await Q.getNextPort()).port}getProfile(e){return this.profiles.find(r=>r.id===e)}}de=new WeakMap,ve=new WeakMap,ge=new WeakMap;const ms=new rs;function ss(t,e){return t===null?!1:t.total_gb===e.total_gb&&t.available_gb===e.available_gb&&t.used_gb===e.used_gb&&t.percent_used===e.percent_used&&t.mlx_recommended_gb===e.mlx_recommended_gb}function is(t,e){return t===null?!1:t.os_version===e.os_version&&t.chip===e.chip&&t.memory_gb===e.memory_gb&&t.python_version===e.python_version&&t.mlx_version===e.mlx_version&&t.mlx_openai_server_version===e.mlx_openai_server_version}var pe,_e,me,ye;class as{constructor(){N(this,pe,C(null));N(this,_e,C(null));N(this,me,C(!1));N(this,ye,C(null));L.register("system-memory",{interval:3e4,minInterval:5e3,refreshFn:()=>this.doRefreshMemory()})}get memory(){return m(u(this,pe))}set memory(e){O(u(this,pe),e,!0)}get info(){return m(u(this,_e))}set info(e){O(u(this,_e),e,!0)}get loading(){return m(u(this,me))}set loading(e){O(u(this,me),e,!0)}get error(){return m(u(this,ye))}set error(e){O(u(this,ye),e,!0)}async doRefreshMemory(){try{const e=await ct.memory();ss(this.memory,e)||(this.memory=e)}catch(e){console.error("Failed to fetch memory:",e)}}async refreshMemory(){return L.refresh("system-memory")}startMemoryPolling(){L.start("system-memory")}stopMemoryPolling(){L.stop("system-memory")}async refreshInfo(){this.loading=!0;try{const e=await ct.info();is(this.info,e)||(this.info=e)}catch(e){this.error=e instanceof Error?e.message:"Failed to fetch system info"}finally{this.loading=!1}}async refresh(){await Promise.all([this.refreshMemory(),this.refreshInfo()])}}pe=new WeakMap,_e=new WeakMap,me=new WeakMap,ye=new WeakMap;const ys=new as;/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var os=wr("<svg><!><!></svg>");function Ss(t,e){const r=it(e,["children","$$slots","$$events","$$legacy"]),s=it(r,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);hr(e,!1);let i=x(e,"name",8,void 0),a=x(e,"color",8,"currentColor"),n=x(e,"size",8,24),o=x(e,"strokeWidth",8,2),l=x(e,"absoluteStrokeWidth",8,!1),c=x(e,"iconNode",24,()=>[]);const h=(...P)=>P.filter(($,f,v)=>!!$&&v.indexOf($)===f).join(" ");br();var g=os();ft(g,(P,$)=>({...ns,...s,width:n(),height:n(),stroke:a(),"stroke-width":P,class:$}),[()=>(se(l()),se(o()),se(n()),st(()=>l()?Number(o())*24/Number(n()):o())),()=>(se(i()),se(r),st(()=>h("lucide-icon","lucide",i()?`lucide-${i()}`:"",r.class)))]);var d=vr(g);zr(d,1,c,Cr,(P,$)=>{var f=mr(()=>yr(m($),2));let v=()=>m(f)[0],F=()=>m(f)[1];var I=Pr(),S=_r(I);Fr(S,v,!0,(M,_)=>{ft(M,()=>({...F()}))}),at(P,I)});var y=gr(d);Lr(y,e,"default",{}),pr(g),at(t,g),dr()}export{Ss as I,ze as S,Q as a,Lr as b,vs as c,Vr as d,zr as e,Ur as f,ys as g,Ce as h,jr as i,L as j,Se as k,Dr as l,ps as m,gs as n,ft as o,ms as p,Hr as r,_s as s};
